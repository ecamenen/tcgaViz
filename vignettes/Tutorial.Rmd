  ---
title: "Tutorial"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(tcgaViz)
library(ggpubr, quietly = TRUE)
```

#### Load two data sets
(with the same cancer type and TCGA sample identifiers)
```{r data}
data(tcga)
head(tcga$genes)
head(tcga$cells$Cibersort_ABS)
```

#### Violin plot of cell subtypes
(and significance of a Wilcoxon adjusted test according to the expression
 level [high or low] of a selected gene)
```{r plot}
df <- convert2biodata(
  algorithm = "Cibersort_ABS",
  disease = "breast invasive carcinoma",
  tissue = "Primary Tumor",
  gene_x = "A"
)
stats <- calculate_pvalue(df)
plot_violin(df, stats = stats, title = "")
```

```{r end}
sessionInfo()
```
